<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>College Event Management</title>
<style>
/* your existing CSS here ... same as before */
body { font-family:'Segoe UI',sans-serif; margin:0; color:#fff; overflow-x:hidden; background:url('background.jpg') no-repeat center center fixed; background-size:cover; }
nav { background:rgba(0,0,0,0.7); padding:15px 30px; display:flex; justify-content:space-between; align-items:center; position:sticky; top:0; z-index:1000; }
nav h1 { color:#ffd700; font-size:1.5em; }
nav ul { list-style:none; display:flex; gap:20px; margin:0; padding:0; }
nav ul li a { color:#fff; text-decoration:none; font-weight:600; cursor:pointer; transition:0.3s; }
nav ul li a:hover { color:#ffd700; }
section { display:none; padding:40px; min-height:100vh; }
#home { display:flex; justify-content:center; align-items:center; flex-direction:column; text-align:center; margin:0; padding:120px 20px; background:rgba(0,0,0,0.6); border-radius:20px; box-shadow:0 8px 25px rgba(0,0,0,0.25); }
#home h2 { font-size:3em; margin-bottom:20px; color:#ffd700; }
#home button { padding:15px 40px; border:none; border-radius:30px; font-size:1.1em; font-weight:bold; cursor:pointer; background: rgba(255,255,255,0.2); color:#fff; backdrop-filter: blur(10px); box-shadow:0 6px 15px rgba(0,0,0,0.2); transition:0.4s; }
#home button:hover { background:#ffd700; color:#222; transform:translateY(-3px); }
.back-btn { margin-top:20px; padding:10px 20px; background:#444; color:#fff; border:none; border-radius:10px; cursor:pointer; }
.back-btn:hover { background:#ffd700; color:#000; }
#event-cards { display:flex; flex-wrap:wrap; gap:20px; margin-top:20px; }
.event-card { background:rgba(0,0,0,0.7); padding:20px; border-radius:12px; box-shadow:0 6px 15px rgba(0,0,0,0.5); width:250px; text-align:center; transition:0.3s; color:#fff; position:relative; overflow:hidden; }
.event-card::before { content:""; position:absolute; inset:0; background:rgba(0,0,0,0.3); }
.event-card h3, .event-card p { position:relative; z-index:1; }
.event-card:hover { transform:translateY(-5px); box-shadow:0 10px 20px rgba(0,0,0,0.7); }
form { max-width:500px; margin:auto; background:rgba(0,0,0,0.7); padding:40px; border-radius:20px; box-shadow:0 10px 25px rgba(0,0,0,0.5); }
form input, form select, form button { width:100%; padding:15px; margin-bottom:20px; border-radius:12px; font-size:1em; }
form input, form select { border:1px solid #ddd; transition:0.3s; }
form input:focus, form select:focus { border-color:#ffd700; outline:none; }
form button { border:none; border-radius:25px; font-weight:bold; cursor:pointer; background:linear-gradient(135deg,#ffd700,#ff9900); color:#000; transition:0.3s; box-shadow:0 6px 15px rgba(0,0,0,0.5); }
form button:hover { transform:translateY(-3px); box-shadow:0 10px 25px rgba(0,0,0,0.7); }
.event-participants { max-width:700px; margin:40px auto; background:rgba(0,0,0,0.6); padding:20px; border-radius:12px; }
.event-participants h3 { color:#ffd700; margin-bottom:10px; }
.event-participants table { width:100%; border-collapse:collapse; margin-bottom:30px; }
.event-participants th, .event-participants td { border:1px solid #ccc; padding:10px; text-align:left; background: rgba(255,255,255,0.1); }
.event-participants th { background:#ffd700; color:#000; }
.no-participants { font-style:italic; color:#bbb; padding:10px 0; }
.delete-btn { background:#ff4d4d; color:#fff; padding:5px 10px; border:none; border-radius:8px; cursor:pointer; margin-left:10px; }
.delete-btn:hover { background:#e60000; }
</style>
</head>
<body>

<section id="home">
  <h2>Welcome to College Event Management ðŸŽ“</h2>
  <p>Organize, participate, and celebrate college events ðŸš€</p>
  <div style="display:flex; gap:20px; justify-content:center; flex-wrap:wrap;">
    <button onclick="userEntry()">User Entry</button>
    <button onclick="showLogin()">Admin Entry</button>
  </div>
</section>

<section id="setup">
  <form onsubmit="setAdmin(event)">
    <h2>Set Admin Password</h2>
    <input type="text" id="setup-user" placeholder="Username" required>
    <input type="password" id="setup-pass" placeholder="Password" required>
    <button type="submit">Save</button>
  </form>
  <button class="back-btn" onclick="backHome()">â¬… Back</button>
</section>

<section id="login">
  <form onsubmit="adminLogin(event)">
    <h2>Admin Login</h2>
    <input type="text" id="admin-user" placeholder="Username" required>
    <input type="password" id="admin-pass" placeholder="Password" required>
    <button type="submit">Login</button>
  </form>
  <button class="back-btn" onclick="backHome()">â¬… Back</button>
</section>

<div id="main-app">
  <nav>
    <h1>ðŸŽ‰ College Events</h1>
    <ul>
      <li><a onclick="showPage('events')">Events</a></li>
      <li><a onclick="showPage('register')">Register</a></li>
      <li><a onclick="showPage('admin')">Admin</a></li>
      <li><a onclick="showPage('manage')">Manage Events</a></li>
      <li><a onclick="logout()">Logout</a></li>
    </ul>
  </nav>

  <section id="events"><h2>Upcoming Events</h2><div id="event-cards"></div></section>
  <section id="register">
    <form onsubmit="registerEvent(event)">
      <h2>Register for Event</h2>
      <input type="text" id="name" placeholder="Your Name" required>
      <input type="email" id="email" placeholder="Your Email" required>
      <select id="event" required></select>
      <input type="text" id="year" placeholder="Year" required>
      <input type="text" id="branch" placeholder="Branch" required>
      <input type="text" id="section" placeholder="Section" required>
      <button type="submit">Register</button>
    </form>
    <div id="participants-container"></div>
  </section>
  <section id="admin"><h2>Participants by Event</h2><div id="admin-participants"></div></section>
  <section id="manage">
    <form onsubmit="addEvent(event)">
      <h2>Manage Events</h2>
      <input type="text" id="new-event" placeholder="New Event Name" required>
      <input type="file" id="new-event-image" accept="image/*">
      <button type="submit">Add Event</button>
    </form>
    <div id="manage-list"></div>
  </section>
</div>

<!-- Firebase v9 compat -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
// --- Firebase Config ---
const firebaseConfig = {
  apiKey: "AIzaSyDfvvkCShi6kPiserR2Ec3DOV8PXMMbHyQ",
  authDomain: "http://college-event-management-7f48b.firebaseapp.com/",
  databaseURL: "https://college-event-management-7f48b-default-rtdb.firebaseio.com/",
  projectId: "college-event-management-7f48b",
  storageBucket: "http://college-event-management-7f48b.firebasestorage.app/",
  messagingSenderId: "932574155247",
  appId: "1:932574155247:web:b17a9c4b9342fd58c2e61a"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// --- Variables ---
let events=[], participants=[], isAdmin=false;

// --- Functions ---
function backHome(){ document.querySelectorAll("section").forEach(s=>s.style.display="none"); document.getElementById("main-app").style.display="none"; document.getElementById("home").style.display="block"; }
function userEntry(){ isAdmin=false; loadFirebase(); document.getElementById("home").style.display="none"; document.getElementById("main-app").style.display="block"; showPage('events'); }
function showLogin(){ document.getElementById("home").style.display="none"; if(localStorage.getItem("adminUser") && localStorage.getItem("adminPass")) document.getElementById("login").style.display="block"; else document.getElementById("setup").style.display="block"; }
function setAdmin(e){ e.preventDefault(); localStorage.setItem("adminUser", document.getElementById("setup-user").value); localStorage.setItem("adminPass", document.getElementById("setup-pass").value); alert("Admin saved!"); document.getElementById("setup").style.display="none"; document.getElementById("login").style.display="block"; }
function adminLogin(e){ e.preventDefault(); if(document.getElementById("admin-user").value===localStorage.getItem("adminUser") && document.getElementById("admin-pass").value===localStorage.getItem("adminPass")){ isAdmin=true; alert("Admin logged in!"); document.getElementById("login").style.display="none"; document.getElementById("main-app").style.display="block"; loadFirebase(); showPage('events'); } else alert("Wrong credentials!"); }
function logout(){ isAdmin=false; backHome(); }
function showPage(p){ if((p==='admin'||p==='manage')&&!isAdmin){ alert("Only admin!"); return; } document.querySelectorAll("#main-app section").forEach(s=>s.style.display="none"); document.getElementById(p).style.display="block"; if(p==='events') renderEvents(); if(p==='register'){ loadEventOptions(); displayParticipants(); } if(p==='admin') displayParticipantsAdmin(); if(p==='manage') displayManageEvents(); }

// --- Firebase Load ---
function loadFirebase(){
  db.ref('events').once('value').then(s=>{ events=s.val()||[]; renderEvents(); loadEventOptions(); displayManageEvents(); });
  db.ref('participants').once('value').then(s=>{ participants=s.val()||[]; displayParticipants(); displayParticipantsAdmin(); });
}
function saveEvents(){ db.ref('events').set(events); }
function saveParticipants(){ db.ref('participants').set(participants); }

// --- Events ---
function renderEvents(){ const c=document.getElementById("event-cards"); c.innerHTML=""; events.forEach(ev=>{ const img=ev.image||"https://via.placeholder.com/250"; c.innerHTML+=`<div class="event-card" style="background-image:url('${img}'); background-size:cover; background-position:center;"><h3>${ev.name}</h3><p>Join us for ${ev.name}!</p></div>`; }); }
function loadEventOptions(){ const s=document.getElementById("event"); s.innerHTML=""; events.forEach(ev=>s.innerHTML+=`<option value="${ev.name}">${ev.name}</option>`); }

// --- Registration ---
function registerEvent(e){ e.preventDefault(); const data={name:document.getElementById("name").value,email:document.getElementById("email").value,event:document.getElementById("event").value,year:document.getElementById("year").value,branch:document.getElementById("branch").value,section:document.getElementById("section").value}; participants.push(data); saveParticipants(); alert("Registered!"); e.target.reset(); displayParticipants(); }
function displayParticipants(){ const c=document.getElementById("participants-container"); c.innerHTML=""; events.forEach(ev=>{ const evPart=participants.filter(p=>p.event===ev.name); let h=`<div class="event-participants"><h3>${ev.name}</h3>`; if(evPart.length===0) h+=`<p class="no-participants">No participants yet.</p>`; else{ h+=`<table><thead><tr><th>Name</th><th>Email</th><th>Year</th><th>Branch</th><th>Section</th></tr></thead><tbody>`; evPart.forEach(p=> h+=`<tr><td>${p.name}</td><td>${p.email}</td><td>${p.year}</td><td>${p.branch}</td><td>${p.section}</td></tr>`); h+=`</tbody></table>`; } h+=`</div>`; c.innerHTML+=h; }); }
function displayParticipantsAdmin(){ const c=document.getElementById("admin-participants"); c.innerHTML=""; events.forEach(ev=>{ const evPart=participants.filter(p=>p.event===ev.name); let h=`<div class="event-participants"><h3>${ev.name}</h3>`; if(evPart.length===0) h+=`<p class="no-participants">No participants yet.</p>`; else{ h+=`<table><thead><tr><th>Name</th><th>Email</th><th>Year</th><th>Branch</th><th>Section</th></tr></thead><tbody>`; evPart.forEach(p=> h+=`<tr><td>${p.name}</td><td>${p.email}</td><td>${p.year}</td><td>${p.branch}</td><td>${p.section}</td></tr>`); h+=`</tbody></table>`; } h+=`</div>`; c.innerHTML+=h; }); }

// --- Manage Events ---
function addEvent(e){ e.preventDefault(); const name=document.getElementById("new-event").value.trim(); const file=document.getElementById("new-event-image").files[0]; if(!name||events.some(ev=>ev.name===name)){ alert("Empty or duplicate!"); return; } if(file){ const reader=new FileReader(); reader.onload=e=>{ events.push({name,image:e.target.result}); saveEvents(); displayManageEvents(); renderEvents(); loadEventOptions(); alert("Event added!"); }; reader.readAsDataURL(file); } else{ events.push({name,image:""}); saveEvents(); displayManageEvents(); renderEvents(); loadEventOptions(); alert("Event added!"); } document.getElementById("new-event").value=""; document.getElementById("new-event-image").value=""; }
function deleteEvent(name){ if(confirm(`Delete "${name}" and all registrations?`)){ events=events.filter(ev=>ev.name!==name); participants=participants.filter(p=>p.event!==name); saveEvents(); saveParticipants(); displayManageEvents(); renderEvents(); displayParticipants(); displayParticipantsAdmin(); loadEventOptions(); } }
function displayManageEvents(){ const c=document.getElementById("manage-list"); c.innerHTML="<h3>All Events:</h3><ul>"; events.forEach(ev=>c.innerHTML+=`<li>${ev.name} <button class="delete-btn" onclick="deleteEvent('${ev.name}')">Delete</button></li>`); c.innerHTML+="</ul>"; }
</script>
</body>
</html>
